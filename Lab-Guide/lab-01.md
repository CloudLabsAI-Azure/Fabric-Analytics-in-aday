  ![](../Images/lab-01/image002.png)  

## 目次
ドキュメントの構造	3 <br>
シナリオ / 問題の説明	3 <br>
Power BI Desktop レポートの概要	5 <br>
    タスク 1: ラボ環境で Power BI Desktop を設定する	5 <br>
    タスク 2: Power BI Desktop レポートを分析する	8 <br>
    タスク 3: Power Query を確認する	12 <br>
リファレンス	16 <br>

# ドキュメントの構造

このラボでは、実行する手順だけでなく、視覚的にわかりやすいように、手順に関連するス クリーンショットも提示されます。各スクリーンショットでは、ユーザーが注目する必要の ある領域が、オレンジのボックスで強調表示されて示されます。

# シナリオ/ 問題の説明

Fabrikam, Inc. は、ノベルティ商品の卸売業者です。卸売業者である Fabrikam の顧客のほとんどは、個人に再販する会社です。Fabrikam は、専門店、スーパーマーケット、コンピューター販売店、観光名所の店など、アメリカ合衆国全土の小売顧客に販売しています。また、Fabrikam では、Fabrikam に代わって製品の販売促進を行う代理店のネットワークを通じて、他の卸売業者にも販売しています。現在、Fabrikam の顧客はすべてアメリカ合衆国に拠点を置いていますが、同社では他の国や地域への拡大を推進しようと考えています。

あなたは営業チームのデータアナリストです。データセットの収集、クリーンアップ、解釈を行ってビジネス上の問題を解決します。また、チャートやグラフなどの視覚エフェクトをまとめたり、レポートを作成したり、それらを組織の意思決定者にプレゼンしたりもします。

データから貴重な分析情報を引き出すには、さまざまなシステムからデータを取得し、ク リーンアップして、まとめてマッシュアップする必要があります。データは次のソースから 取得できます。

- **販売データ:** ERP システムから取得します。データは ADLS Gen2 データベースまたは <br>
      Databricks に格納されます。毎日正午 (午後 0 時) に更新されます。<br>

- **仕入先データ:** さまざまな仕入先から取得します。データは Snowflake データベースに格納されます。毎日真夜中 (午前 0 時) に更新されます。<br>

- **顧客データ:** Customer Insights から取得します。データは Dataverse に格納されます。データは常に最新の状態です。<br>

- **従業員データ:**  人事システムから取得します。エクスポート ファイルとして<br>
      SharePoint フォルダーに格納されます。毎朝午前 9 時に更新されます。<br>

  ![](../Images/lab-01/image006.jpg)  

あなたは現在、Power BI Premium で上記のソース システムからデータを取得するデータセットを構築しています。その目的は、自分のレポート作成のニーズを満たし、エンド ユーザーにセルフサービス機能を提供することです。モデルの更新には Power Query を使います。


## 直面している課題:

- 各種データ ソースごとに異なる更新時間に対応するには、1 日に少なくとも 3 回はデータセットを更新する必要があります。

- ソース システムで発生したすべての更新を取得するために毎回完全な更新を行う必要があるため、更新に長い時間がかかります。

- 取得元のデータ ソースでエラーが発生すると、データセットの更新が中断されま す。従業員ファイルが時間どおりにアップロードされず、データセットの更新が中 断されてしまうことが何度もあります。

- データ モデルに変更を加えるのに非常に長い時間がかかります。データ サイズが大きくて変換が複雑だと、Power Query によるプレビューの更新に時間がかかるためです。

- 社内標準は Mac ですが、Power BI Desktop を使用するにはWindows PC が必要です。

Microsoft Fabric について聞いたあなたは、それを使って課題に対処できるかどうかを見てみることにしました。

# Power BI Desktop レポートの概要

Fabric の説明を始める前に、変換とモデルについて理解するために現在の Power BI Desktop

のレポートを見てみましょう。

## タスク 1: ラボ環境でPower BI Desktop を設定する

1.	自分のラボ環境の **C:\FAIAD\Reports** フォルダーにある **FAIAD.pbix** を開きます。Power BI Desktop でファイルが開かれます。

    ![](../Images/lab-01/image009.png)  

2.	[メール アドレスの入力] ダイアログが開きます。ラボ環境の右パネルにある**環境の詳細**タブに移動します。

3.	**ユーザー名**をコピーし、ダイアログの [電子メール]  テキストボックスに貼り付けます。

4.	**続行**を選択します。

    ![](../Images/lab-01/image012.jpg)  

5.	[サインインする方法] ダイアログが開きます。**職場または学校アカウント**を選択します。
 
6.	**続行**を選択します。

    ![](../Images/lab-01/image015.png)  

7.	[サインイン]  ダイアログが開きます。**ユーザー名を環境の詳細**タブからコピーしてもう一度入力します。

8.	**次へ**を選択します。

    ![](../Images/lab-01/image018.jpg)  

9.	次のダイアログで、**パスワード**の**資格情報を環境の詳細**タブからコピーして入力します。

10.	**サインイン**を選択します。
 
11.	[Action Required] ダイアログが開き、多要素認証の設定が求められます。これはラボ環境であるため、設定する必要はありません。**Ask later** を選択します。

    ![](../Images/lab-01/image021.png)  

12.	次のダイアログで、いいえ、**このアプリのみにサインインします**を選択します。これで

Power BI Desktop が開きます。

## タスク 2: Power BI Desktop レポートを分析する

以下のレポートでは、Fabrikam の売上を分析しています。ページの左上に KPI が一覧表示さ れています。残りのビジュアルは、担当地域、製品グループ、リセラー会社ごとの時系列に 沿った売上を強調しています。

![](../Images/lab-01/image024.jpg)  

**注:** このトレーニングでは、Fabric で利用できるツールを使ったデータの取得、変換、モデリングに焦点を当てています。レポートの作成やナビゲーションには焦点を当てません。数分かけてレポートを理解してから、次のステップに進みましょう。

1.	営業担当地域別にデータを分析してみましょう。**Sales Territory のNew England** (散布図)
ビジュアルを選択します。売上の推移からわかるように、New England ではリセラーTailspin Toys がWingtip Toys よりも多くの売上をあげています。Sales YoY% の縦棒グラフを見ると、過去 1 年間のWingtip Toys の売上成長率が低く、四半期ごとに減少していることがわかります。第 3 四半期で少し回復したものの、第 4 四半期で再び下がりました。
 
    ![](../Images/lab-01/image027.jpg)   

2.	これを Rocky Mountain の担当地域と比較してみましょう。**Sales Territory のRocky Mountain** (散布図) ビジュアルを選択します。Sales YoY% の縦棒グラフを見ると、Wingtip
Toys の売上は、2 回の四半期で低かった後 2022 年の第 4 四半期で急激に増えていることがわかります。

    ![](../Images/lab-01/image030.jpg)  

3.	**Sales Territory のRocky Mountain** を選択して、フィルターを外します。
 
4.	画面の下部中央にある散布図ビジュアル (Sales 別の Sales Orders) から、右上の外れ値を選択します (第 4 象限)。Margin % は 52% であり、平均の 50% を上回っていることがわかります。また、2022 年の最後 2 回の四半期では、Sales YoY% が増加 
    しています。

    ![](../Images/lab-01/image033.jpg)  

5.	散布図ビジュアルで外れ値のリセラーを選択して、**フィルターを外します。**

6.	製品グループとリセラー別に製品の詳細を取得してみましょう。製品グループおよびリセラー会社ごとの売上の横棒グラフのビジュアルから、**Tailspin Toys のPackaging Materials
    バーを右クリック**し、ダイアログから**ドリルスルー-> 製品の詳細**を選択します。
 
    ![](../Images/lab-01/image036.jpg)   

    製品の詳細を提供するページに移動します。今後の注文もいくつかあることがわかります。

7.	このページの確認が完了したら、ページの右上にある **Ctrl + 戻る矢印**をクリックして売上レポートに戻ります。

    ![](../Images/lab-01/image039.jpg)  
 
8.	自由にレポートをさらに分析してみてください。準備ができたら、モデル ビューを見てみましょう。左パネルで、**モデル ビュー アイコン**を選択します。Sales とPO という 2 つのファクト テーブルがあることがわかります。
a.	Sales データの粒度は、Date、Reseller、Product、People によって提供されています。Date、Reseller、Product、People が Sales につながっています。
b.	PO データの粒度は、Date、Product、People によって提供されています。Date、
    Product、People がPO につながっています。
c.	Product ごとの Supplier データがあります。Supplier はProduct につながっています。
d.	Geo によるReseller の場所データがあります。Geo はReseller につながっています。
e.	Reseller ごとの Customer 情報があります。Customer はReseller につながっています。

## タスク 3: Power Query を確認する

1.	Power Query を調べてデータ ソースについて理解しましょう。リボンから**ホーム -> データの変換**を選択します。

    ![](../Images/lab-01/image042.jpg)  
 
2.	Power Query ウィンドウが開きます。リボンから**ホーム -> データ ソース設定**を選択しま
す。[データ ソース設定] ダイアログが開きます。一覧をスクロールしていくと、問題の説明で述べたように 4 つのデータ ソースがあることがわかります。
a.	Snowflake
b.	SharePoint
c.	ADLS Gen2
d.	Dataverse

3.	**閉じる**を選択して [データソース設定]  ダイアログを閉じます。

    ![](../Images/lab-01/image045.jpg)

4.	左側の [クエリ] パネルでは、各クエリがデータ ソースごとにグループ化されていることがわかります。

5.	**DataverseData** フォルダーには、BabyBoomer、GenX、GenY、GenZ という 4 つの異なるクエリで使用できる Customer  データが含まれています。これら 4 つのクエリをアペンドして、Customer クエリを作成します。

6.	Dataverse データソースの資格情報を入力するには、**環境変数**タブ ([ラボ ガイド] の隣)
    で確認できる**ユーザー名**と**パスワード**を入力します。Microsoft  アカウントのオプションを選択してください。
 
    ![](../Images/lab-01/image048.jpg)

7.	ADLS データソースの場合は、**アカウントキー** オプションを使用し、**環境変数**タブ ([ラボガイド] の隣) で確認できる**ADLS ストレージアカウントのアクセスキー**を入力します。

8.	**ADLSData** フォルダーには複数のディメンション (Geo、Product、Reseller、Date) があることがわかります。Sales ファクトもあります。<br>
a.	**Geo ディメンション**は、Cities、Countries、States の各クエリからのデータをマー
    ジすることで作成されます。<br>
b.	**Product ディメンション**は、Product Groups とProduct Item Group のクエリからのデータをマージすることで作成されます。<br>
c.	**Reseller ディメンション**は、BuyingGroup クエリを使ってフィルター処理されます。<br>
d.	**Sales ファクト**は、InvoiceLineItems とInvoice のクエリをマージすることで作成されます。<br>

9.	Snowflake データソースの場合は、**環境変数**タブ ([ラボ ガイド] の隣) で確認できる
    **Snowflake ユーザー名と Snowflake パスワード**を使用します。
 
10.	**SnowflakeData** フォルダーには、Supplier ディメンションとPO (Order / Spend) ファクトが含まれていることがわかります。<br>
a.	**Supplier ディメンション**は、Suppliers クエリと SupplierCategories クエリをマージ
    することで作成されます。<br>
b.	**PO ファクト**は、PO とPO Line Items のクエリをマージすることで作成されます。<br>

11.	SharePoint データ ソースの場合は、**環境変数**タブ ([ラボ ガイド] の隣) で確認できる
    ユ**ーザー名**と**パスワード**を入力します。Microsoft  アカウントのオプションを選択してください。

12.	**SharepointData** フォルダーには People ディメンションが含まれていることがわかります。

    ![](../Images/lab-01/image051.png) 
 
これで、私たちが何を扱っているかがわかりました。以降のラボでは、Dataflow Gen2 を使って同様の Power Query を作成し、Lakehouse を使ってモデルを作成します。

# リファレンス

Fabric Analyst in a Day (FAIAD) では、Microsoft Fabric で使用できる主要な機能の一部をご紹介します。サービスのメニューにあるヘルプ (?) セクションには、いくつかの優れたリソースへのリンクがあります。

![](../Images/lab-01/image054.png) 

- ブログ記事で Microsof t Fabric のGA に関するお知らせの全文を確認する
- ガイド付きツアーを通じて Fabric を探索する
- Microsof t Fabric の無料試用版にサインアップする
- Microsof t Fabric のWeb サイトにアクセスする
- Fabric の学習モジュールで新しいスキルを学ぶ
- Fabric の技術ドキュメントを参照する
- Fabric 入門編の無料のe-book を読む
- Fabric コミュニティに参加し、質問の投稿やフィードバックの共有を行い、他のユーザーから学びを得る

より詳しい Fabric  エクスペリエンスのお知らせに関するブログを参照してください。

- Fabric の Data Factory エクスペリエンスに関するブログ 
- Fabric のSynapse Data Engineering エクスペリエンスに関するブログ
- Fabric のSynapse Data Science エクスペリエンスに関するブログ
- Fabric のSynapse Data Warehousing エクスペリエンスに関するブログ
- Fabric のSynapse Real-Time Analytics エクスペリエンスに関するブログ
- Power BI のお知らせに関するブログ
- Fabric の Data Activator エクスペリエンスに関するブログ
- Fabric の管理とガバナンスに関するブログ
- Fabric の OneLake に関するブログ
- Dataverse とMicrosof t Fabric の統合に関するブログ



© 2023 Microsoft Corporation. All rights reserved.

このデモ/ラボを使用すると、次の条件に同意したことになります。

このデモ/ラボで説明するテクノロジまたは機能は、ユーザーのフィードバックを取得 し、学習エクスペリエンスを提供するために、Microsoft Corporation によって提供されます。ユーザーは、このようなテクノロジおよび機能を評価し、Microsoft にフィードバックを提供するためにのみデモ/ラボを使用できます。それ以外の目的には使用できませ ん。このデモ/ラボまたはその一部を、変更、コピー、配布、送信、表示、実行、再現、 発行、ライセンス、著作物の作成、転送、または販売することはできません。
複製または再頒布のために他のサーバーまたは場所にデモ/ラボ (またはその一部) をコピーまたは複製することは明示的に禁止されています。
 
このデモ/ラボは、前に説明した目的のために複雑なセットアップまたはインストールを 必要としないシミュレーション環境で潜在的な新機能や概念などの特定のソフトウェアテクノロジ/製品の機能を提供します。
このデモ/ラボで表されるテクノロジ/概念は、フル機能を表していない可能性があり、最終バージョンと動作が異なることがあります。また、そのような機能や概念の最終版がリリースされない場合があります。物理環境でこのような機能を使用するエクスペリエンスが異なる場合もあります。

**フィードバック**。このデモ/ラボで説明されているテクノロジ、機能、概念に関する フィードバックをMicrosoft に提供する場合、ユーザーは任意の方法および目的でユー
ザーのフィードバックを使用、共有、および商品化する権利を無償で Microsoft に提供するものとします。また、ユーザーは、フィードバックを含む Microsoft のソフトウェアまたはサービスの特定部分を使用したり特定部分とインターフェイスを持ったりする製 品、テクノロジ、サービスに必要な特許権を無償でサード パーティに付与します。ユーザーは、フィードバックを含めるために Microsoft がサード パーティにソフトウェアま たはドキュメントをライセンスする必要があるライセンスの対象となるフィードバックを提供しません。これらの権限は、本契約の後も存続します。
Microsoft Corporation は、明示、黙示、または法律上にかかわらず、商品性のすべての保証および条件、特定の目的、タイトル、非侵害に対する適合性など、デモ/ラボに関する すべての保証および条件を拒否します。Microsoft は、デモ/ラボから派生する結果、出力の正確さ、任意の目的に対するデモ/ラボに含まれる情報の適合性に関して、いかなる 保証または表明もしません。

**免責事項**

このデモ/ラボには、Microsoft Power BI の新機能と機能強化の一部のみが含まれています。一部の機能は、製品の将来のリリースで変更される可能性があります。このデモ/ラ ボでは、新機能のすべてではなく一部について学習します。

