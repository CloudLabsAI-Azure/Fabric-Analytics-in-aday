![](../Images/lab-03/heading.png)

## 目录

简介	

数据流 Gen2	

- 任务 1：创建数据流Gen2	

- 任务 2：创建与ADLS Gen2 的连接	

- 任务 3：创建基ADLS Gen2 文件夹查询	

- 任务 4：创建 Cities 查询	

- 任务 5：创建 Countries 查询

- 任务 6：使用复制创建 States - 选项1	

- 任务 7：通过复制创建Geo 查询- 选项 2	

- 任务 8：为Geo 查询配置数据目标

- 任务 9：发布数据流	2

- 任务 10：重命名数据流	

- 任务 11：在数据流中生成剩余查询	

- 任务 12：为剩余查询配置数据目标	

参考


## 简介

在我们的应用场景中，销售数据来自ERP 系统，存储在ADLS Gen2 中。每天中午 12 点更新。我们需要将这些数据转换并引入到 Lakehouse 中，并在我们的模型中使用这些数据。引入此数据的方法有多种。

-	**快捷方式** ：这不是转换数据的方法。

- **笔记本**：这需要我们编写代码。这种方法适合开发人员。

- **数据流 Gen2：** 您可能熟悉 Power Query 或数据流Gen1。数据流Gen2 顾名思义是数据流的新版本。它提供Power Query/数据流 Gen1 的所有功能，并添加了将数据转换和引入到多个数据源的功能。我们将在下面几个实验中进行介绍。

- **数据管道：** 这是一个编排工具。可以编排活动来提取、转换和引入数据。我们将使用数据管道执行数据流Gen2 活动，该活动又将执行提取、转换和引入。

我们将从数据流Gen2 开始，创建与数据源的连接和必要的转换。然后我们将使用数据管道来编排/执行数据流 Gen2。

本实验结束后，您将学会：

- 如何创建数据流Gen2

- 如何使用数据流Gen2 连接到 ADLS Gen2 并转换数据

- 如何将数据引入 Lakehouse


## 数据流 Gen2

### 任务 1：创建数据流 Gen2


1.	让我们导航回到您在实验 2 任务 9 中创建的 Fabric **工作区**。

2.	如果您在上一个实验之后尚未离开，您将位于 Lakehouse 屏幕中。如果您已离开，没有关系。选择屏幕左下角的 **Fabric 体验选择器**图标。

3.	从打开的 Fabric 体验对话框中选择 **Data Factory**。Data Factory 具有提取、转换和引入数据所需的工作负载。

![](../Images/lab-03/image1.png)

4.	您将导航到 Data Factory 主页。在“新建”下，选择**数据流 Gen2。**

![](../Images/lab-03/image2.png)

您将导航到**数据流页面**。此屏幕看起来很熟悉，因为它与数据流Gen1 或Power Query 相似。您会注意到这里提供了连接到各种数据源的选项以及转换数据的功能。我们连接到ADLS Gen2数据源并执行一些转换。

### 任务 2：创建与ADLS Gen2 的连接

1.	从功能区中选择主页 -> 获取数据 -> 更多…
![](../Images/lab-03/image3.jpg)
